(this.webpackJsonpauth=this.webpackJsonpauth||[]).push([[0],{243:function(e,t,a){e.exports=a(446)},274:function(e,t,a){},446:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),o=a.n(c),s=a(44),l=a(18),u=a(11),i=a.n(u),m=a(34),p=a(23),d=a(101),b=a(40),f=a(88),g=a(484),h=a(148),E=a(481),v=a(196),w=(a(273),a(274),function(e){var t=e.children;e.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{title:"title",meta:[{name:"description",content:"Sample"},{name:"keywords",content:"sample, something"}]},r.a.createElement("html",{lang:"en"})),r.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"0px 1.0875rem 1.45rem",paddingTop:0}},t))}),O=a(482),j=Object(s.atom)({key:"loggedInUser",default:{sub:null,email_verified:null,phone_number_verified:null,email:null,username:null,token:null}}),y=Object(s.atom)({key:"navigation",default:"home"}),x=a(483),k={UserNotFoundException:"Username does not exist",AuthError:"Username or Password cannot be empty",CodeMismatchException:"Invalid code, please try again",NotAuthorizedException:"Username or Password invalid",UsernameExistsException:"The user does not exist",PasswordNotMatch:"Passwords do not match",InvalidParameterException:"The password need to be at least 6 symbols",Empty:""},C=function(e){return r.a.createElement("div",null,Object.entries(e).map((function(e){var t=Object(p.a)(e,2),a=(t[0],t[1]);return"Empty"!==a.name&&r.a.createElement(x.a,{description:k[a.name]?k[a.name]:"".concat(a.message,"-").concat(a.name),type:"error"})})))},I={Input:{height:40,margin:"10px 0px",padding:7,width:"100%"},formContainer:{display:"flex",flexDirection:"column"},button:{backgroundColor:"rebeccapurple",padding:"15px 7px",cursor:"pointer",textAlign:"center",marginBottom:10},buttonText:{color:"white"}},S=function(e){var t=e.type,a=Object(s.useRecoilState)(j),c=Object(p.a)(a,2),o=c[0],u=c[1],d=Object(n.useState)(""),b=Object(p.a)(d,2),f=b[0],g=b[1],h=Object(n.useState)(""),v=Object(p.a)(h,2),w=v[0],x=v[1],k=Object(n.useState)(null),S=Object(p.a)(k,2),T=S[0],P=S[1],_=Object(s.useRecoilState)(y),N=Object(p.a)(_,2),U=N[0],F=N[1];Object(n.useEffect)((function(){F("login")}),[F,U]);var R=function(){var e=Object(m.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.signIn(f,w);case 3:return e.next=5,E.a.currentAuthenticatedUser();case 5:return t=e.sent,e.next=8,E.a.currentSession();case 8:a=e.sent,n=Object(l.a)(Object(l.a)({},t.attributes),{},{username:t.username,token:a.accessToken.jwtToken,refreshtoken:a.refreshToken.token}),u(n),localStorage.setItem("user",JSON.stringify(n)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),P(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,o.x&&r.a.createElement(C,{errorMessage:T}),T&&r.a.createElement(C,{errorMessage:T}),"compact"===t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{onChange:function(e){return g(e.target.value)},placeholder:"username",name:"username",value:f,style:I.InputCompact}),r.a.createElement(O.a,{onChange:function(e){return x(e.target.value)},placeholder:"password",name:"password",value:w,type:"password",style:I.InputCompact}),r.a.createElement("div",{style:I.buttonCompact,onClick:R},r.a.createElement("span",{style:I.buttonCompact},"\u0412\u0445\u043e\u0434"))),"full"===t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{onChange:function(e){return g(e.target.value)},placeholder:"Username",name:"username",value:f,style:I.Input}),r.a.createElement(O.a,{onChange:function(e){return x(e.target.value)},placeholder:"Password",name:"password",value:w,type:"password",style:I.Input}),r.a.createElement("div",{style:I.button,onClick:R},r.a.createElement("span",{style:I.buttonText},"Login"))))},T=a(49),P={Input:{height:40,margin:"10px 0px",padding:7},formContainer:{display:"flex",flexDirection:"column"},button:{backgroundColor:"rebeccapurple",padding:"15px 7px",cursor:"pointer",textAlign:"center",marginBottom:10},buttonText:{color:"white"}},_=function(){var e=Object(s.useRecoilState)(y),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({username:"",password:"",email:"",authCode:"",stage:0,error:""}),u=Object(p.a)(o,2),d=u[0],b=u[1];Object(n.useEffect)((function(){c("signup")}),[c,a]);var f=function(e){b(Object(l.a)(Object(l.a)({},d),{},Object(T.a)({},e.target.name,e.target.value)))},g=function(){var e=Object(m.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.username,a=d.password,n=d.email,e.prev=1,e.next=4,E.a.signUp({username:t,password:a,attributes:{email:n}});case 4:b(Object(l.a)(Object(l.a)({},d),{},{stage:1,error:{name:"Empty"}})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),b(Object(l.a)(Object(l.a)({},d),{},{error:e.t0})),console.log("error signing up...",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(m.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.username,a=d.authCode,e.prev=1,e.next=4,E.a.confirmSignUp(t,a);case 4:b(Object(l.a)(Object(l.a)({},d),{},{stage:2,error:{name:"Empty"}})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),b(Object(l.a)(Object(l.a)({},d),{},{error:e.t0})),console.log("error confirming signing up...",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,0===d.stage&&r.a.createElement("div",{style:P.formContainer},r.a.createElement("h1",null,"Sign Up"),d.error&&r.a.createElement(C,{errorMessage:d.error}),r.a.createElement(O.a,{onChange:f,placeholder:"Username",name:"username",value:d.username,style:P.Input}),r.a.createElement(O.a,{onChange:f,placeholder:"Password",name:"password",value:d.password,type:"password",style:P.Input}),r.a.createElement(O.a,{onChange:f,placeholder:"Email",name:"email",value:d.email,style:P.Input}),r.a.createElement("div",{style:P.button,onClick:g},r.a.createElement("span",{style:P.buttonText},"Sign Up"))),1===d.stage&&r.a.createElement("div",{style:P.formContainer},r.a.createElement("h1",null,"Registration"),d.error&&r.a.createElement(C,{errorMessage:d.error}),r.a.createElement(O.a,{onChange:f,placeholder:"Authorization Code",name:"authCode",value:d.authCode,style:P.Input}),r.a.createElement("div",{style:P.button,onClick:h},r.a.createElement("span",{style:P.buttonText},"Confirm Sign Up"))),2===d.stage&&r.a.createElement(r.a.Fragment,null,"Registratino successful ,",r.a.createElement("a",{href:"/app/login"},"Login")))},N={Input:{height:40,margin:"10px 0px",padding:7,width:"100%"},formContainer:{display:"flex",flexDirection:"column"},button:{backgroundColor:"rebeccapurple",padding:"15px 7px",cursor:"pointer",textAlign:"center",marginBottom:10},buttonText:{color:"white"}},U=function(){var e=Object(s.useRecoilState)(y),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({username:"",error:"",validation:"",password:"",confirmPassword:"",stage:0}),u=Object(p.a)(o,2),d=u[0],b=u[1];Object(n.useEffect)((function(){c("forgot")}),[c,a]);var f=function(){var e=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.forgotPassword(d.username);case 3:b(Object(l.a)(Object(l.a)({},d),{},{stage:1})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b(Object(l.a)(Object(l.a)({},d),{},{error:e.t0}));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),g=function(){b(Object(l.a)(Object(l.a)({},d),{},{stage:2}))},h=function(){var e=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d.password!==d.confirmPassword){e.next=7;break}return e.next=4,E.a.forgotPasswordSubmit(d.username,d.validation,d.password);case 4:b(Object(l.a)(Object(l.a)({},d),{},{stage:3,error:{name:"Empty"}})),e.next=8;break;case 7:b(Object(l.a)(Object(l.a)({},d),{},{error:{name:"PasswordNotMatch",message:"Passwords don't Match"}}));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),b(Object(l.a)(Object(l.a)({},d),{},{error:e.t0}));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),v=function(e){b(Object(l.a)(Object(l.a)({},d),{},Object(T.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",null,r.a.createElement("h1",null,"Forgot Password"),d.error&&r.a.createElement(C,{errorMessage:d.error}),0===d.stage&&r.a.createElement("div",{style:N.formContainer},r.a.createElement(O.a,{onChange:v,placeholder:"username",name:"username",value:d.username,style:N.Input}),r.a.createElement("div",{role:"button",tabIndex:0,style:N.button,onClick:f,onKeyDown:f},r.a.createElement("span",{style:N.buttonText},"Next"))),1===d.stage&&r.a.createElement("div",null,r.a.createElement("div",null,"Check your email for confirmation code"),r.a.createElement(O.a,{onChange:v,placeholder:"confirmation code",name:"validation",value:d.validation,style:N.Input}),r.a.createElement("div",{role:"button",tabIndex:0,style:N.button,onClick:g,onKeyDown:g},r.a.createElement("span",{style:N.buttonText},"\u041e\u041a"))),2===d.stage&&r.a.createElement("div",null,r.a.createElement(O.a,{type:"password",onChange:v,placeholder:"new password",name:"password",value:d.password,style:N.Input}),r.a.createElement("br",null),r.a.createElement(O.a,{type:"password",onChange:v,placeholder:"confirm password",name:"confirmPassword",value:d.confirmPassword,style:N.Input}),r.a.createElement("div",{role:"button",tabIndex:0,href:"/",style:N.button,onClick:h,onKeyDown:h},r.a.createElement("span",{style:N.buttonText},"Change password"))),3===d.stage&&r.a.createElement(r.a.Fragment,null,r.a.createElement(r.a.Fragment,null,"Password changed ,",r.a.createElement("a",{href:"/app/login"},"Login"))))},F=function(){var e=Object(s.useRecoilState)(y),t=Object(p.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){c("home")}),[c,a]),r.a.createElement("div",null,r.a.createElement("h1",null,"Welcome"))},R=a(39),A=a(478),J=a(134),M=a(66),D=a(479),z=a(235),q=a(132),L=a.n(q),B={api:"https://47ruk9bopl.execute-api.eu-central-1.amazonaws.com/dev"},K=function(){var e=Object(m.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.get("".concat(B.api).concat(t),{headers:{test:"emperror",accesstoken:a,"Content-Type":"application/json"}});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e){e(n)})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),V=function(){var e=Object(m.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.post("".concat(B.api,"/db"),JSON.stringify(t),{headers:{accesstoken:a,"Content-Type":"application/json"}});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e){e(n)})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=Object(m.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.post("".concat(B.api,"/insert"),JSON.stringify(t),{headers:{accesstoken:a,"Content-Type":"application/json"}});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e){e(n)})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Z=function(e){var t=e.user,a=Object(s.useRecoilState)(y),c=Object(p.a)(a,2),o=c[0],u=c[1],d=Object(n.useState)({Items:[]}),b=Object(p.a)(d,2),f=b[0],g=b[1],h=Object(J.b)(),E=h.control,v=h.errors,w=h.handleSubmit,O=h.setValue,j=function(){var e=Object(m.a)(i.a.mark((function e(a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(l.a)(Object(l.a)({},a),{},{vreme:(new Date).getTime(),tip:"test-"}),g(f.Items?{Items:[n].concat(Object(R.a)(f.Items))}:{Items:[n]}),e.next=4,W(n,t.token);case 4:return e.next=6,W(Object(l.a)(Object(l.a)({},n),{},{tip:"test-all"}),t.token);case 6:O("task",""),O("email","");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){u("home")}),[u,o]),Object(n.useEffect)((function(){function e(){return(e=Object(m.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V({collection:"test-",descending:!1},t.token);case 2:a=e.sent,g(a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),r.a.createElement("div",null,r.a.createElement("h1",null,t.username),r.a.createElement("form",{onSubmit:w(j)},r.a.createElement("div",{className:"inputwrapper"},r.a.createElement(J.a,{as:r.a.createElement(A.a,{id:"outlined-basic",error:!!v.task,label:v.task?"task is required":"task",variant:"outlined",style:{width:"100%"}}),name:"task",control:E,defaultValue:"",rules:{required:!0}})),r.a.createElement("div",{className:"inputwrapper"},r.a.createElement(J.a,{as:r.a.createElement(A.a,{id:"outlined-basic",error:!!v.email,label:v.email?"email is not valiud":"email",variant:"outlined",style:{width:"100%"}}),name:"email",control:E,defaultValue:"",rules:{required:!0,pattern:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i}})),r.a.createElement(M.a,{type:"primary",htmlType:"submit"},"Submit")),r.a.createElement("hr",null),r.a.createElement(D.a,{rowKey:"vreme",dataSource:f.Items,columns:[{title:"Task",dataIndex:"task",key:"task"},{title:"Email",dataIndex:"email",key:"email"},{title:"date",dataIndex:"vreme",key:"date",render:function(e){return r.a.createElement("div",null,r.a.createElement(z.a,{datetime:new Date(e),locale:"bg_BG"}))}}]}))};h.a.configure({aws_project_region:"eu-west-1",aws_cognito_identity_pool_id:"eu-west-1:3f5f916d-2252-487f-99c0-7aa69115f973",aws_cognito_region:"eu-west-1",aws_user_pools_id:"eu-west-1_T6v05tjzh",aws_user_pools_web_client_id:"eqlretnsetkj5p57bqtandjqa",oauth:{}});var G=function(){var e=Object(s.useRecoilState)(j),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(s.useRecoilValue)(y),u=Object(n.useState)(!1),h=Object(p.a)(u,2),v=h[0],O=h[1],x=function(e,t){var a=Object(n.useState)((function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return console.log(n),t}})),r=Object(p.a)(a,2),c=r[0],o=r[1];return[c,function(t){try{var a=t instanceof Function?t(c):t;o(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(n){console.log(n)}}]}("theme",!1),k=Object(p.a)(x,2),C=k[0],I=k[1],T=function(){var e=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem("user",JSON.stringify({sub:null})),e.next=3,E.a.signOut();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e=localStorage.getItem("user"),t=e?JSON.parse(e):{sub:null};c(t),O(!0)}),[c,v]),Object(n.useEffect)((function(){if(a.sub){var e=setInterval(Object(m.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K("/heartbeat",a.token);case 2:if("TokenExpiredError"!==e.sent.data.name){e.next=11;break}return e.next=6,E.a.currentAuthenticatedUser();case 6:return t=e.sent,e.next=9,E.a.currentSession();case 9:n=e.sent,t.refreshSession(n.refreshToken,(function(e,t){var n=Object(l.a)(Object(l.a)({},a),{},{token:t.accessToken.jwtToken});c(n),localStorage.setItem("user",JSON.stringify(n))}));case 11:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearInterval(e)}}}),[a,c]),r.a.createElement(d.a,null,v&&r.a.createElement("div",{className:C?"dark":"white"},r.a.createElement(f.a,{selectedKeys:[o],mode:"horizontal"},r.a.createElement(f.a.Item,{key:"home"},r.a.createElement(d.b,{to:"/"},"Home")),null===a.sub?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a.Item,{key:"login"},r.a.createElement(d.b,{to:"/app/login"},"Login")),r.a.createElement(f.a.Item,{key:"signup"},r.a.createElement(d.b,{to:"/app/signup"},"Sign Up")),r.a.createElement(f.a.Item,{key:"forgot"},r.a.createElement(d.b,{to:"/app/forgot"},"Forgot Password"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a.Item,{key:"logout"},r.a.createElement("a",{href:"/",onClick:function(){return E.a.signOut().then(T())}},"Logout")))),r.a.createElement("div",{className:"switcher"},r.a.createElement(g.a,{defaultChecked:C,onChange:function(){return I(!C)}})),r.a.createElement(w,null,r.a.createElement(b.d,null,r.a.createElement(b.b,{path:"/app/login"},null===a.sub?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Login"),r.a.createElement(S,{type:"full"})):r.a.createElement(b.a,{to:"/"})),r.a.createElement(b.b,{path:"/app/forgot"},r.a.createElement(U,null)),r.a.createElement(b.b,{path:"/app/signup"},r.a.createElement(_,null)),r.a.createElement(b.b,{path:"/"},null===a.sub?r.a.createElement(F,null):r.a.createElement(Z,{user:a}))))))};o.a.render(r.a.createElement(s.RecoilRoot,null,r.a.createElement(G,null)),document.getElementById("root"))}},[[243,1,2]]]);
//# sourceMappingURL=main.112b51bd.chunk.js.map